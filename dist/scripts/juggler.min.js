!function(a,b){if("function"==typeof define&&define.amd)define(["marionette","backbone","underscore"],function(c,d,e){return a.Juggler=b(a,c,d,e)});else if("undefined"!=typeof exports){var c=require("marionette"),d=require("backbone"),e=require("underscore");module.exports=b(a,c,d,e)}else a.Juggler=b(a,a.Marionette,a.Backbone,a._)}(this,function(a,b,c){"use strict";var d=a.Juggler,e=c.Juggler=new b.Application;return e.VERSION="0.0.0",e.noConflict=function(){return a.Juggler=d,this},c.Juggler=e,e.module("Config",function(a){a.Message={}}),e.module("Templates",function(a,b,c,d,e,f){a.dialog=f.template('<div class="modal-dialog">                <div class="modal-content">                    <div class="modal-header alert alert-<%- type %>">                     <button type="button" class="close" data-dismiss="modal">                     <span aria-hidden="true">&times;</span>                     <span class="sr-only">Close</span></button>                     <h4 class="modal-title"><%= title %></h4>                    </div>                    <div class="modal-body"><%= body %></div>                    <div class="modal-footer">                    <button class="btn btn-primary">确定</button>                    </div>                </div>            </div>'),a.alert=f.template('<button type="button" class="close" data-dismiss="alert">            <span aria-hidden="true">&times;</span>            <span class="sr-only">Close</span>        </button>        <span class="alert-message">            <%= message %>        </span>'),a.form=f.template(""),a.form_row=f.template('<label class="col-md-2 control-label" for="<%- name %>"><%- label %></label>        <div class="col-md-10 control-field"></div>        '),a.navbar=f.template('<div class="container">          <div class="navbar-header">            <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar-collapse">              <span class="sr-only">Toggle navigation</span>              <span class="icon-bar"></span>              <span class="icon-bar"></span>              <span class="icon-bar"></span>            </button>            <a class="navbar-brand" href="#"><%= brand %></a>          </div>          <div class="collapse navbar-collapse" id="navbar-collapse" data-region="navbar">            <ul class="nav navbar-nav navbar-nav-primary"></ul>            <ul class="nav navbar-nav navbar-nav-secondary"></ul>          </div>        </div>'),a.panel=f.template('<div class="panel-heading"><%= header %></div>            <div class="panel-body"><%= body %></div>            <div class="panel-footer"><%= footer %></div>')}),e.module("Enities",function(a,b,c,d,e,f){a.model_to_collection=function(b,c,d,e){return e=e||a.Collection,c=c||"name",d=d||"label",new e(f.map(b.toJSON(),function(a,b){var e={};return e[c]=a,e[d]=b,e}))},a.Model=c.RelationalModel.extend({urlRoot:"/test",message:b.Config.Message,parse:function(a,b){return b.collection?a:a.data},index:function(){return this.collection.indexOf(this)},prev:function(){return this.collection.at(this.index()-1)},next:function(){return this.collection.at(this.index()+1)}}),a.Collection=c.Collection.extend({url:"/test",message:b.Config.Message,parse:function(a,b){return b.collection?a:a.data}}),a.Cell=a.Model.extend({}),a.Row=a.Collection.extend({model:a.Cell}),a.Column=a.Model.extend({defaults:{name:void 0,label:void 0,sortable:!1,editable:!1,renderable:!0,formatter:void 0,sortType:"cycle",sortValue:void 0,direction:null,cell:void 0,headerCell:void 0}}),a.Columns=a.Collection.extend({model:a.Column}),a.Field=a.Model.extend({defaults:{label:"label",editor:"Input"}}),a.Fields=a.Collection.extend({model:a.Field}),a.Form=a.Model.extend({})}),e.module("Views",function(a,b,c,d,e,f){a.ItemView=d.ItemView.extend({template:f.template(""),templateHelpers:function(){return this.options}}),a.EmptyView=a.ItemView.extend({className:"alert alert-warning",template:f.template("<%= text %>"),options:{text:"not found！"}}),a.LayoutView=d.LayoutView.extend({className:"row",regionAttr:"data-region",template:f.template(""),render:function(){this.resolveUIRegions(),a.LayoutView.__super__.render.apply(this,arguments),this.resolveTemplateRegions()},resolveUIRegions:function(){if(this.ui)for(var a in this.ui)this.addRegion(a+"Region",this.ui[a])},resolveTemplateRegions:function(){var a=this,b=this.regionAttr,c="["+b+"]";this.$el.find(c).each(function(c,d){var f=e(d).attr(b);f&&a.addRegion(e.camelCase(f)+"Region","["+b+"="+f+"]")}),this.triggerMethod("resoveregion")},templateHelpers:function(){return this.options}}),a.CompositeView=d.CompositeView.extend({emptyView:a.EmptyView,childViewContainer:"",template:f.template(""),childViewOptions:function(){return{parentModel:this.model}},templateHelpers:function(){return this.options}}),a.ListItemView=a.ItemView.extend({tagName:"li",template:f.template('<a data-target="#<%- name %>" data-toggle="tab"><%- label %></a>'),triggers:{"click a":"click"}}),a.ListView=a.CompositeView.extend({tagName:"ul",template:f.template(""),childView:a.ListItemView,childEvents:{click:"onClick"},onClick:function(a){c.history.navigate(a.model.get("name"))}})}),e.module("Widgets",function(a,b,c,d,e,f){a.Dialog=b.Views.LayoutView.extend({className:"modal fade",template:b.Templates.dialog,options:{type:"success",size:"md",title:"",body:"",buttons:{positive:{},negative:{}},backdrop:"static"},ui:{header:".modal-title",body:".modal-body",footer:".modal-footer"},get:function(a){return f.extend(this.serializeData(),this.templateHelpers())[a]},set:function(a,b){this[a+"Region"].close(),this.model?this.model.set(a,b):(this.options[a]=b,this.ui[a].html(b)),b?this.ui[a].show():this.ui[a].hide()},onRender:function(){return this.get("header")?this.ui.header.show():this.ui.header.hide(),this.get("footer")?this.ui.footer.show():this.ui.footer.hide(),this.options.buttons?void 0:void this.ui.footer.remove()},onShow:function(){this.$el.modal(this.options)},onClose:function(){this.$el.modal("destroy")}}),a.Alert=b.Views.ItemView.extend({className:"alert alert-dismissable fade in animated juggler-alert",template:b.Templates.alert,options:{type:"warning",message:""},events:{"close.bs.alert":"onClose"},initialize:function(){this.$el.addClass("alert-"+this.options.type)},onShow:function(){this.$el.css("margin-left",-this.$el.outerWidth()/2+"px"),this.$el.addClass("bounceInDown")},onClose:function(){this.destroy()}}),a.Progressbar=d.ItemView.extend({className:"progress progress-striped active juggler-progress",template:f.template('<div class="progress-bar"></div>'),options:{type:"success"},ui:{bar:".progress-bar"},modelEvents:{progress:"onProgress"},progress:function(a){return a=0>a?0:a,a=a>100?100:a,a>=100?this.destroy():void this.ui.bar.css("width",a+"%")},onRender:function(){this.ui.bar.addClass("progress-bar-"+this.options.type)},onProgress:function(a){this.progress(a)}}),a.Panel=b.Views.LayoutView.extend({className:"panel panel-default",template:b.Templates.panel,ui:{header:".panel-heading",body:".panel-body",footer:".panel-footer"},options:{header:"",body:"",footer:""},get:function(a){return f.extend(this.serializeData(),this.templateHelpers())[a]},set:function(a,b){this[a+"Region"].close(),this.model?this.model.set(a,b):(this.options[a]=b,this.ui[a].html(b)),b?this.ui[a].show():this.ui[a].hide()},onRender:function(){this.get("header")?this.ui.header.show():this.ui.header.hide(),this.get("footer")?this.ui.footer.show():this.ui.footer.hide()}}),a.GroupList=b.Views.ListView.extend({className:"list-group",childView:b.Views.ListItemView.extend({className:"list-group-item"})}),a.Tabs=b.Views.ListView.extend({className:"nav nav-tabs"}),a.Pills=b.Views.ListView.extend({className:"nav nav-pills"}),a.Stack=b.Views.ListView.extend({className:"nav nav-pills nav-stacked"}),a.Nav=b.Views.ListView.extend({className:"nav navbar-nav"}),a.Breadcrumb=b.Views.ListView.extend({className:"breadcrumb"}),a.Navbar=b.Views.ListView.extend({tagName:"div",template:b.Templates.navbar,childViewContainer:".navbar-nav-primary",className:"navbar navbar-static-top navbar-default",options:{brand:"Home"},serializeData:function(){return this.options}}),a.DropdownMenu=b.Views.ListItemView.extend({className:"dropdown-menu"}),a.Pagination=b.Views.ListItemView.extend({className:"pagination"}),a.MediaList=b.Views.ListItemView.extend({className:"media-list"}),a.Th=b.Views.ItemView.extend({tagName:"th",template:f.template("<%= label %>")}),a.Td=b.Views.ItemView.extend({tagName:"td",template:f.template("<%= text %>"),serializeData:function(){return{text:this.options.parentModel.get(this.model.get("name"))}}}),a.Tr=b.Views.CompositeView.extend({tagName:"tr",childView:a.Td}),a.Thead=a.Tr.extend({childView:a.Th}),a.Tbody=b.Views.CompositeView.extend({childView:a.Tr,childViewOptions:function(){return{collection:this.options.columns}}}),a.Table=b.Views.LayoutView.extend({tagName:"table",className:"table table-hover table-striped",childView:a.Tr,childViewContainer:"tbody",template:f.template("<thead></thead><tbody></tbody><tfoot></tfoot>"),regions:{theadRegion:"thead",tbodyRegion:"tbody",tfootRegion:"tfoot"},initialize:function(){this.head=new a.Thead({collection:this.options.columns,parent:this}),this.body=new a.Tbody({collection:this.collection,columns:this.options.columns}),this.tbodyRegion.attachHtml=function(a){this.$el.html(a.$el.html())}},onRender:function(){this.theadRegion.show(this.head),this.tbodyRegion.show(this.body)}}),a.GridLayout=b.Views.LayoutView.extend({className:"grid-layout",template:function(a){var b=a.items||[a],c=f.map(b,function(a){var b=f.map(a,function(a,b){var c,d;return d=f.isNaN(Number(b))?b:"col-"+b,c=f.map(a,function(a,b){return f.isObject(a)?f.map(a,function(a,c){return"col-"+b+"-"+c+(a?"-"+a:"")}).join(" "):"col-"+b+"-"+a}).join(" "),'<div class="'+c+'" data-region="'+d+'"></div>'}).join("");return'<div class="row">'+b+"</div>"}).join("");return c}}),a.Field=b.Views.LayoutView.extend({className:"form-group",template:b.Templates.form_row,ui:{label:".control-label",field:".control-field"},initialize:function(){this.Editor=b.module("Editors."+this.serializeData().editor),this.model.set("value",this.options.parentModel.get(this.model.get("name")))},onRender:function(){var a=new this.Editor({model:this.model});this.fieldRegion.show(a)}}),a.Form=b.Views.CompositeView.extend({tagName:"form",childView:a.Field,options:{type:"horizontal"},initialize:function(){this.setType(this.options.type)},setType:function(a){this.$el.removeClass("form-"+this.options.type).addClass("form-"+a),this.options.type=a}})}),e.module("Editors",function(a,b){a.Base=b.Views.ItemView.extend({className:"form-control",setName:function(a){this.$el.attr("name",a)},setValue:function(a){this.$el.val(a)},getValue:function(){return this.$el.val()},onRender:function(){this.setValue(this.model.get("value")),this.setName(this.model.get("name"))}}),a.Input=a.Base.extend({tagName:"input"}),a.Textarea=a.Base.extend({tagName:"textarea",className:"form-control",setValue:function(a){this.$el.text(a)},getValue:function(){return this.$el.text()}}),a.Select=b.Views.CompositeView.extend({tagName:"select",className:"form-control",childView:b.Views.ItemView.extend({tagName:"option",onRender:function(){this.$el.attr("value",this.model.get("value")).text(this.model.get("name"))}}),initialize:function(){this.collection=new b.Enities.Collection(this.model.get("options"))},onRender:function(){this.setValue(this.model.get("value"))},setValue:function(a){this.$el.find("[value="+a+"]").attr("selected","selected")},getValue:function(){return this.$el.val()}}),a.Checkbox=a.Input.extend({attrs:{type:"checkbox"}}),a.Checkboxes=b.Views.CompositeView.extend({className:"checkbox",childView:a.Checkbox})}),e.module("Components",function(a,b){a.FormRow=b.Views.ItemView.extend({className:"form-group",template:b.Templates.form_row}),a.Form=b.Views.CompositeView.extend({tagName:"form",childView:a.FormRow})}),e.addInitializer(function(){e.addRegions({headerRegion:"#header",navRegion:"#nav",mainRegion:"#main",footerRegion:"#footer",notifyRegion:"#notify",dialogRegion:"#dialog"})}),e.on("start",function(){c.history&&c.history.start()}),e});